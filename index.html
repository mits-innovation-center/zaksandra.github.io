// query our HTML elements using their ids / class names
const endInningButton = document.querySelector("#end-inning");
const awayScoreButton = document.querySelector("#away-score");
const homeScoreButton = document.querySelector("#home-score");

// Create an object to hold the state of our game
const state = {
  inning: 0,
  totalInnings: 3,
  teams: {
    home: {
      name: "Chicago Cubs",
      innings: [0],
      total: 0
    },
    away: {
      name: "Pittsburgh Pirates",
      innings: [0],
      total: 0
    }
  }
};

// Create an object to store different element queries
const elements = {
  teams: {
    home: {
      name: document.querySelector(".home .name"),
      innings: document.querySelectorAll(".home .inning"),
      total: document.querySelector(".home .total")
    },
    away: {
      name: document.querySelector(".away .name"),
      innings: document.querySelectorAll(".away .inning"),
      total: document.querySelector(".away .total")
    }
  }
};

// Set team names on load
elements.teams.home.name.textContent = state.teams.home.name;
elements.teams.away.name.textContent = state.teams.away.name;

// Create a function to run when a team scores
function handleScore(teamName) {
  const { inning, teams } = state;
  const team = teams[teamName];

  // update state
  team.innings[inning]++;
  team.total++;

  // update elements
  const teamElements = elements.teams[teamName];

  const inningElement = teamElements.innings[inning];
  inningElement.textContent = team.innings[inning];

  const totalElement = teamElements.total;
  totalElement.textContent = team.total;
}

// Create a function to run when we finish an inning
function handleEndOfInning() {
  if (state.inning > state.totalInnings - 1) {
    return;
  } else if (state.inning === state.totalInnings - 1) {
    endInningButton.disabled = true;
    awayScoreButton.disabled = true;
    homeScoreButton.disabled = true;
  }

  const { teams, inning, totalInnings } = state;

  // update the HTML elements for both teams
  for (let teamName of ["home", "away"]) {
    const team = teams[teamName];

    // update state
    team.innings.push(0);

    // update elements
    const teamElements = elements.teams[teamName];

    // update the current (stale) inning element
    const currentInning = teamElements.innings[inning];
    currentInning.classList.toggle("current-inning");

    if (!team.innings[inning]) {
      currentInning.textContent = "0";
    }

    // If we're out of innings, stop here
    if (inning >= totalInnings - 1) {
      continue;
    } else {
      // Update the new inning element
      const nextInning = teamElements.innings[state.inning + 1];
      nextInning.classList.toggle("current-inning");
    }
  }
  // Increment the inning
  state.inning++;
}

// connect our functions to our HTML button elements
endInningButton.onclick = handleEndOfInning;

awayScoreButton.onclick = function() {
  handleScore("away");
};
homeScoreButton.onclick = function() {
  handleScore("home");
};

